<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.1.1.min.js"></script>
  <script src="ajax_functions.js"></script>

	<title>Dynamic map page</title>
	<style>
		body {
			font-family:Arial, Helvetica, sans-serif;
			font-size:14px;
		}

		h1 {
			height: 3vh;
		}
		label {
			font-weight:bold;
			width:100px;
			font-size:14px;
		}

		.box {
			border:#666666 solid 1px;
		}

    #info_list {
      height: 90vh;
			width: 10%;
			float: left;
			margin: 5px;
    }

		#map {
			height: 90vh;
			width: 70%;
			float: left;
			margin: 5px;
		}

		#details {
			height: 90vh;
			width: 18%;
			float: left;
			margin: 5px;
		}

	</style>
</head>

<body>
	<h1>Dynamic map</h1>

  <div id="info_list">
    <h3>List of requests</h3>
    <ul id="requests_list ">
      <li><span>Requets ID: </span> <span id="request_id">123</span></li>
      <li><span>Requets ID: </span> <span id="request_id">123</span></li>
    </ul>
      <h3>List of drivers</h3>
      <ul id="requests_list ">
        <li><span>Requets ID: </span> <span id="request_id">123</span></li>
        <li><span>Requets ID: </span> <span id="request_id">123</span></li>
      </ul>

  </div>

	<div id="map">
	</div>
	<div id="detials">
		<div id="empty_details">
			<h3>Click on a marker to see options</h3>
		</div>

		<div id="request_details">
			<h3>Request details</h3>
			<ul>
				<li><span>Requets ID: </span> <span id="request_id">123</span></li>
				<li><span>Time: </span> <span id="request_time">8:23 3/10/2017</span></li>
				<li><span>Notes: </span> <span id="request_notes">Hello, world!</span></li>
				<li><span>Price: </span> <span id="request_price">53 SDG</span></li>
				<li><span>Status: </span> <span id="request_status">Pending</span></li>
				<li><span>Passenger name: </span> <span id="passenger_name">Ayman Hassan Salim Gumaa</span></li>
				<li><span>Passenger phone: </span> <span id="passenger_phone">09123122123</span></li>
				<li><span>Driver name: </span> <span id="driver_name">Islam Abdalla</span></li>
				<li><span>Driver phone: </span> <span id="driver_phone">09123212112</span></li>
			</ul>

		</div>

		<div id="driver_details"></div>


		<script>
		window.globals = {};

			function initMap() {
				var khartoumCords = {lat: 15.592791, lng: 32.534134};
				window.globals.map = new google.maps.Map(document.getElementById('map'), {
					zoom: 11,
					center: khartoumCords
				});
		}

    function  shworMrakersAndDrivers(listOfRequests, listOfDrivers){

      for (var i = 0; i < listOfRequests.length; i++) {
      	request = listOfRequests[i];
				window.globals.requestMarkers = [];
				var marker = new google.maps.Marker({
					position: {lat:  Number(request.pickup_lat) , lng:  Number(request.pickup_lng)},
					map: window.globals.map,
					data: request
				});
			window.globals.requestMarkers[i] = marker;
			window.globals.requestMarkers[i].details = request;
			google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          // console.log(marker.data.request_id);
					showRequestDetails(marker.data);
        }
      })(marker, i));

      }
      console.log(listOfDrivers);
    }

		function showMrker(){

		}

		function showRequestDetails(requestDetails){
			console.log(requestDetails.request_id);
			// console.log("Request id: ".requestDetails);
		}

	</script>
	<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB3OefEn0Ul0NJcBKU2ShzVZ8FMBGIT3qM&callback=initMap">
</script>

</body>
</html>
